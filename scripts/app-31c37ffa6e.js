!function(){"use strict";angular.module("formioAppBasic",["ngSanitize","ui.router","ui.bootstrap","formio"]).config(["$stateProvider","$urlRouterProvider","FormioProvider","ResourceProvider","AppConfig","$injector",function(e,r,o,t,n,i){o.setBaseUrl(n.apiUrl),e.state("home",{url:"/",templateUrl:"views/home.html"}).state("auth",{"abstract":!0,url:"/auth",templateUrl:"views/user/auth.html"}).state("auth.login",{url:"/login",templateUrl:"views/user/login.html",controller:["$scope","$state","$rootScope",function(e,r,o){e.$on("formSubmission",function(e,t){t&&(o.user=t,r.go("home"))})}]}).state("auth.register",{url:"/register",templateUrl:"views/user/register.html",controller:["$scope","$state","$rootScope",function(e,r,o){e.$on("formSubmission",function(e,t){t&&(o.user=t,r.go("home"))})}]}),angular.forEach(n.resources,function(e,r){t.register(r,e.form,i.get(e.resource+"Provider"))}),r.otherwise("/")}])}(),angular.module("formioAppBasic").provider("UserResource",function(){return{$get:function(){return null},parent:null,templates:{index:"",view:"",create:"",edit:"","delete":""},params:{index:{},view:{},create:{},edit:{},"delete":{}},controllers:{index:null,"abstract":null,view:null,create:["$scope",function(e){e.$on("formSubmission",function(e,r){console.log(r)})}],edit:["$scope",function(e){e.$on("formSubmission",function(e,r){console.log(r)})}],"delete":["$scope","$stateParams",function(e,r){e.$on("delete",function(e){console.log("Submission Deleted")})}]}}}),angular.module("formioAppBasic").provider("ExpenseResource",function(){return{$get:function(){return null},parent:null,templates:{index:"",view:"",create:"",edit:"","delete":""},params:{index:{},view:{},create:{},edit:{},"delete":{}},controllers:{index:null,"abstract":null,view:null,create:["$scope",function(e){e.$on("formSubmission",function(e,r){console.log(r)})}],edit:["$scope",function(e){e.$on("formSubmission",function(e,r){console.log(r)})}],"delete":["$scope","$stateParams",function(e,r){e.$on("delete",function(e){console.log("Submission Deleted")})}]}}}),angular.module("formioAppBasic").provider("Resource",["$stateProvider",function(e){var r={};return{register:function(o,t,n){r[o]=o;var i=n&&n.parent?n.parent:null,s=o+"Id",a=function(e){var r={};return r[s]=e._id,r},u=function(e){return["$scope","$rootScope","$state","$stateParams","Formio","FormioUtils","$controller",e]},l=n&&n.controllers?n.controllers:{},c=n&&n.templates?n.templates:{};e.state(o+"Index",{url:"/"+o,parent:i?i:null,params:n.params&&n.params.index,templateUrl:c.index?c.index:"views/resource/index.html",controller:u(function(e,r,n,i,u,c,m){e.currentResource={name:o,queryId:s,formUrl:t},e.$on("submissionView",function(e,r){n.go(o+".view",a(r))}),e.$on("submissionEdit",function(e,r){n.go(o+".edit",a(r))}),e.$on("submissionDelete",function(e,r){n.go(o+".delete",a(r))}),l.index&&m(l.index,{$scope:e})})}).state(o+"Create",{url:"/create/"+o,parent:i?i:null,params:n.params&&n.params.create,templateUrl:c.create?c.create:"views/resource/create.html",controller:u(function(e,r,n,i,u,c,m){e.currentResource={name:o,queryId:s,formUrl:t},e.submission={data:{}};var f=!1;if(l.create){var p=m(l.create,{$scope:e});f=p.handle||!1}f||e.$on("formSubmission",function(e,r){n.go(o+".view",a(r))})})}).state(o,{"abstract":!0,url:"/"+o+"/:"+s,parent:i?i:null,templateUrl:"views/resource/resource.html",controller:u(function(e,r,n,a,u,c,m){var f=t+"/submission/"+a[s];e.currentResource=e[o]={name:o,queryId:s,formUrl:t,submissionUrl:f,formio:new u(f),resource:{},form:{},href:"/#/"+o+"/"+a[s]+"/",parent:i?e[i]:{href:"/#/",name:"home"}},e.currentResource.loadFormPromise=e.currentResource.formio.loadForm().then(function(r){e.currentResource.form=e[o].form=r}),e.currentResource.loadSubmissionPromise=e.currentResource.formio.loadSubmission().then(function(r){e.currentResource.resource=e[o].submission=r}),l["abstract"]&&m(l["abstract"],{$scope:e})})}).state(o+".view",{url:"/",parent:o,params:n.params&&n.params.view,templateUrl:c.view?c.view:"views/resource/view.html",controller:u(function(e,r,o,t,n,i,s){l.view&&s(l.view,{$scope:e})})}).state(o+".edit",{url:"/edit",parent:o,params:n.params&&n.params.edit,templateUrl:c.edit?c.edit:"views/resource/edit.html",controller:u(function(e,r,t,n,i,s,u){var c=!1;if(l.edit){var m=u(l.edit,{$scope:e});c=m.handle||!1}c||e.$on("formSubmission",function(e,r){t.go(o+".view",a(r))})})}).state(o+".delete",{url:"/delete",parent:o,params:n.params&&n.params["delete"],templateUrl:c["delete"]?c["delete"]:"views/resource/delete.html",controller:u(function(e,r,t,n,i,s,a){var u=!1;if(l["delete"]){var c=a(l["delete"],{$scope:e});u=c.handle||!1}u||e.$on("delete",function(){t.go(o+"Index")})})})},$get:function(){return r}}}]),angular.module("formioAppBasic").filter("truncate",[function(){return function(e,r){return _.isNumber(r)&&(r={length:r}),_.truncate(e,r)}}]),angular.module("formioAppBasic").filter("capitalize",[function(){return _.capitalize}]),angular.module("formioAppBasic").factory("FormioAlerts",["$rootScope",function(e){var r=[];return{addAlert:function(o){e.alerts.push(o),o.element?angular.element("#form-group-"+o.element).addClass("has-error"):r.push(o)},getAlerts:function(){var e=angular.copy(r);return r.length=0,r=[],e},onError:function o(e){if(e.message)this.addAlert({type:"danger",message:e.message,element:e.path});else{var r=e.hasOwnProperty("errors")?e.errors:e.data.errors;angular.forEach(r,o.bind(this))}}}}]),angular.module("formioAppBasic").run(["$rootScope","$state","$stateParams","Formio","AppConfig","FormioAlerts",function(e,r,o,t,n,i){e.userForm=n.forms.user,e.userRegisterForm=n.forms.userRegister,e.userLoginForm=n.forms.userLogin,angular.forEach(n.forms,function(r,o){e[o]=r}),e.user||t.currentUser().then(function(r){e.user=r});var s=function(e){return function(){localStorage.removeItem("formioUser"),localStorage.removeItem("formioToken"),r.go("auth.login"),i.addAlert({type:"danger",message:e})}};e.$on("formio.sessionExpired",s("Your session has expired. Please log in again.")),e.logout=function(){t.logout().then(function(){r.go("auth.login")})["catch"](s("Your session has expired. Please log in again."))},e.isActive=function(e){return-1!==r.current.name.indexOf(e)},e.$on("$stateChangeStart",function(o,n){e.authenticated=!!t.getToken(),"auth"!==n.name.substr(0,4)&&"admin.login"!==n.name.substr(0,11)&&(e.authenticated||(o.preventDefault(),r.go("auth.login")))}),e.$on("$stateChangeSuccess",function(){e.alerts=i.getAlerts()})}]);