!function(){"use strict";angular.module("formioAppBasic",["ngSanitize","ui.router","ui.bootstrap","formio"]).config(["$stateProvider","$urlRouterProvider","FormioProvider","AppConfig",function(e,r,t,o){t.setBaseUrl(o.apiUrl),e.state("home",{url:"/",templateUrl:"views/main.html"}).state("auth",{"abstract":!0,url:"/auth",templateUrl:"views/user/auth.html"}).state("auth.login",{url:"/login",templateUrl:"views/user/login.html",controller:["$scope","$state","$rootScope",function(e,r,t){e.$on("formSubmission",function(e,o){o&&(t.user=o,r.go("home"))})}]}).state("auth.register",{url:"/register",templateUrl:"views/user/register.html",controller:["$scope","$state","$rootScope",function(e,r,t){e.$on("formSubmission",function(e,o){o&&(t.user=o,r.go("home"))})}]}),r.otherwise("/")}]).factory("FormioAlerts",function(){var e=[];return{addAlert:function(r){e.push(r),r.element?angular.element("#form-group-"+r.element).addClass("has-error"):e.push(r)},getAlerts:function(){var r=angular.copy(e);return e.length=0,e=[],r},onError:function r(e){if(e.message)this.addAlert({type:"danger",message:e.message,element:e.path});else{var t=e.hasOwnProperty("errors")?e.errors:e.data.errors;angular.forEach(t,r.bind(this))}}}}).run(["$rootScope","$state","$stateParams","Formio","AppConfig","FormioAlerts",function(e,r,t,o,n,s){e.userForm=n.forms.userForm,e.userRegisterForm=n.forms.userRegisterForm,e.userLoginForm=n.forms.userLoginForm,angular.forEach(n.forms,function(r,t){e[t]=r}),e.user||o.currentUser().then(function(r){e.user=r});var a=function(){r.go("auth.login"),s.addAlert({type:"danger",message:"Your session has expired. Please log in again."})};e.$on("formio.sessionExpired",a),e.$on("formio.unauthorized",function(){r.go("home")}),e.logout=function(){o.logout().then(function(){r.go("auth.login")})["catch"](a)},e.isActive=function(e){return-1!==r.current.name.indexOf(e)},e.$on("$stateChangeStart",function(t,n){e.authenticated=!!o.getToken(),"auth"!==n.name.substr(0,4)&&"admin.login"!==n.name.substr(0,11)&&(e.authenticated||(t.preventDefault(),r.go("auth.login")))})}])}();